@host = http://localhost:8080
@fixturesRoot = /workspaces/flowtime-vnext/fixtures/time-travel/http-demo

### 1. Service health (confirm API is reachable)
GET {{host}}/v1/healthz
Accept: application/json

### 2. Submit a canonical time-travel model (writes artifacts + topology metadata)
# @name createRun
POST {{host}}/v1/run
Content-Type: text/plain

schemaVersion: 1

grid:
  bins: 4
  binSize: 5
  binUnit: minutes
  startTimeUtc: "2025-01-01T00:00:00Z"

nodes:
  - id: service_arrivals
    kind: const
    values: [10, 12, 11, 13]
  - id: service_served
    kind: const
    values: [9, 11, 10, 12]
  - id: service_errors
    kind: const
    values: [1, 1, 1, 1]
  - id: service_capacity
    kind: const
    values: [12, 12, 12, 12]
  - id: queue_arrivals
    kind: const
    values: [9, 11, 10, 12]
  - id: queue_served
    kind: const
    values: [8, 10, 9, 11]
  - id: queue_errors
    kind: const
    values: [0, 0, 0, 0]
  - id: queue_depth
    kind: const
    values: [2, 4, 5, 3]

outputs:
  - series: service_arrivals
  - series: service_served
  - series: service_errors
  - series: service_capacity
  - series: queue_arrivals
  - series: queue_served
  - series: queue_errors
  - series: queue_depth

topology:
  nodes:
    - id: "OrderService"
      kind: "service"
      semantics:
        arrivals: "file:{{fixturesRoot}}/OrderService_arrivals.csv"
        served: "file:{{fixturesRoot}}/OrderService_served.csv"
        errors: "file:{{fixturesRoot}}/OrderService_errors.csv"
        externalDemand: null
        queueDepth: null
        capacity: "file:{{fixturesRoot}}/OrderService_capacity.csv"
        slaMin: null
    - id: "SupportQueue"
      kind: "queue"
      semantics:
        arrivals: "file:{{fixturesRoot}}/SupportQueue_arrivals.csv"
        served: "file:{{fixturesRoot}}/SupportQueue_served.csv"
        errors: "file:{{fixturesRoot}}/SupportQueue_errors.csv"
        externalDemand: null
        queue: "file:{{fixturesRoot}}/SupportQueue_queue.csv"
        capacity: null
        slaMin: 6
  edges:
    - from: "OrderService"
      to: "SupportQueue"
      weight: 1.0

### 3. Enumerate the generated series metadata
GET {{host}}/v1/runs/{{createRun.response.body.$.runId}}/index
Accept: application/json

### 4. Inspect a single-bin snapshot with derived metrics + colouring
GET {{host}}/v1/runs/{{createRun.response.body.$.runId}}/state?binIndex=1
Accept: application/json

### 5. Retrieve a bin window for scrubber/series views
GET {{host}}/v1/runs/{{createRun.response.body.$.runId}}/state_window?startBin=0&endBin=3
Accept: application/json

### 6. (Optional) Download a raw series for verification
GET {{host}}/v1/runs/{{createRun.response.body.$.runId}}/series/service_arrivals@SERVICE_ARRIVALS@DEFAULT
Accept: text/csv
