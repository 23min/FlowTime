# M3.0 Implementation Tracking

**Milestone:** M3.0 ‚Äî Foundation + Fixtures  
**Started:** 2025-10-08  
**Status:** üîÑ In Progress  
**Branch:** `gold-first-kiss` (experimental)  
**Assignee:** Codex (AI)

---

## Quick Links

- **Milestone Document:** [`docs/milestones/M3.0-foundation-fixtures-spec.md`](../M3.0-foundation-fixtures-spec.md)
- **Related Analysis:** [`docs/gold-first-kiss-analysis.md`](../../gold-first-kiss-analysis.md)
- **Milestone Guide:** [`docs/development/milestone-documentation-guide.md`](../../development/milestone-documentation-guide.md)

---

## Current Status

### Overall Progress
- [ ] Phase 1: Schema Extensions (0/3 tasks)
- [ ] Phase 2: File Sources (3/3 tasks)
- [ ] Phase 3: Initial Conditions (0/1 tasks)
- [ ] Phase 4: Fixtures (0/3 tasks)
- [ ] Phase 5: Integration Tests (0/1 tasks)

### Test Status
- **Unit Tests:** 0 passing / 0 written (TDD pending)
- **Integration Tests:** 0 passing / 0 written
- **Golden/Fixture Tests:** 0 passing / 0 written

---

## Progress Log

### 2025-10-08 - Kickoff Session

**Preparation:**
- [x] Reviewed M3.0 milestone specification
- [x] Confirmed branch (`gold-first-kiss`) for experimental implementation
- [x] Created tracking document
- [ ] Enumerated existing regression tests to watch

**Decisions & Notes:**
- Serena MCP tooling unavailable; standard repo-safe tooling will be used with explicit TDD.
- CSV guidance aligned earlier (headers + `bin_index`), matching fixture expectations.

**Next Steps:**
- [ ] Begin Phase 1 Task 1.1 (write failing tests for `Window` start time)
- [ ] Outline additional unit tests needed per phase before implementation

---

### 2025-10-08 - Phase 1 Kickoff (Window & Topology)

**Changes:**
- Added `WindowTests`, `TopologyTests`, and `ModelParserTopologyTests` (RED) to drive absolute time + topology parsing.
- Introduced core model types (`Window`, `Node`, `NodeSemantics`, `Edge`, `Topology`) and metadata parsing implementation (GREEN).
- Extended `ModelDefinition` schema with `startTimeUtc` and `topology` blocks to back new parser metadata.

**Tests:**
- ‚úÖ `dotnet test tests/FlowTime.Core.Tests/FlowTime.Core.Tests.csproj`

**Next Steps:**
- [ ] Begin Phase 2 Task 2.1 (author failing CSV reader tests)
- [ ] Add semantic loader tests covering optional series

---

## Phase 1: Schema Extensions

**Goal:** Add absolute time support, topology records, and integrate topology into model parsing.

### Task 1.1: Window Start Time Support
**Files:** `src/FlowTime.Core/Models/Window.cs`, `src/FlowTime.Core/Parsing/ModelParser.cs`, `tests/FlowTime.Core.Tests/Models/WindowTests.cs`

**Checklist (TDD order):**
- [x] RED: Add `WindowTests` covering `StartTime`, UTC enforcement, and `GetBinStartTime` edge cases.
- [x] GREEN: Implement `StartTime` property, computed `BinDuration`, and guard clauses in `Window`.
- [x] GREEN: Update parser/deserialization to populate `StartTime`.
- [ ] Commit: `test(core): add window start time coverage`
- [ ] Commit: `feat(core): support absolute window start time`

**Status:** üîÑ In Progress

### Task 1.2: Topology Models
**Files:** `src/FlowTime.Core/Models/Topology*.cs`, `tests/FlowTime.Core.Tests/Models/TopologyTests.cs`

**Checklist (TDD order):**
- [x] RED: Introduce `TopologyTests` covering node lookup, edge navigation, optional semantics, and immutability expectations.
- [x] GREEN: Implement `Topology`, `Node`, `NodeSemantics`, `Edge`, and related records.
- [x] GREEN: Add helper factories and ensure null-handling defaults align with YAML.
- [ ] Commit: `test(core): add topology model coverage`
- [ ] Commit: `feat(core): introduce topology models`

**Status:** üîÑ In Progress

### Task 1.3: Model Schema Integration
**Files:** `src/FlowTime.Core/Models/Model.cs`, `src/FlowTime.Core/Parsing/ModelParser.cs`, `tests/FlowTime.Core.Tests/Parsing/ModelParserTopologyTests.cs`

**Checklist (TDD order):**
- [x] RED: Add parser tests exercising topology parsing, optional absence, and `StartTime` propagation.
- [x] GREEN: Extend model definition and parser to include optional topology and start time.
- [x] GREEN: Ensure backwards-compatible parsing keeps legacy models untouched.
- [ ] Commit: `test(core): add model parser topology coverage`
- [ ] Commit: `feat(core): wire topology into model parser`

**Phase Validation:**
- [x] Build passes with new models
- [x] New tests green, existing suite still passing

**Status:** üîÑ In Progress

---

### 2025-10-08 - Phase 2 Kickoff (CSV Reader)

**Changes:**
- Added `CsvReaderTests` covering happy path, sparse bins, header validation, missing file, and out-of-range bins (RED).
- Implemented `CsvReader` to parse headered telemetry CSVs with invariant culture, zero-fill gaps, and duplicate detection (GREEN).

**Tests:**
- ‚úÖ `dotnet test tests/FlowTime.Core.Tests/FlowTime.Core.Tests.csproj`

**Next Steps:**
- [ ] Add URI resolver tests before implementation
- [ ] Plan semantic loader coverage

---

### 2025-10-08 - Phase 2 Progress (URI Resolver)

**Changes:**
- Added URI resolver unit tests for relative/absolute paths, unsupported schemes, and missing model directory (RED).
- Implemented `UriResolver` to enforce `file:` scheme and combine paths with model directory (GREEN).

**Tests:**
- ‚úÖ `dotnet test tests/FlowTime.Core.Tests/FlowTime.Core.Tests.csproj`

**Next Steps:**
- [ ] Write semantic loader tests covering required/optional semantics and error surfacing
- [ ] Implement `SemanticLoader` using CSV reader and resolver

---

### 2025-10-08 - Phase 2 Progress (Semantic Loader)

**Changes:**
- Added semantic loader tests for required/optional series and missing file behavior (RED).
- Implemented `SemanticLoader` + `NodeData` to hydrate telemetry arrays via CSV reader/resolver (GREEN).

**Tests:**
- ‚úÖ `dotnet test tests/FlowTime.Core.Tests/FlowTime.Core.Tests.csproj`

**Next Steps:**
- [ ] Stage and commit Phase 2 changes
- [ ] Begin Phase 3 Task 3.1 (initial condition validator tests)

---


- Added `CsvReaderTests` covering happy path, sparse bins, header validation, missing file, and out-of-range bins (RED).
- Implemented `CsvReader` to parse headered telemetry CSVs with invariant culture, zero-fill gaps, and duplicate detection (GREEN).

**Tests:**
- ‚úÖ `dotnet test tests/FlowTime.Core.Tests/FlowTime.Core.Tests.csproj`

**Next Steps:**
- [ ] Add URI resolver tests before implementation
- [ ] Plan semantic loader coverage

---

## Phase 2: File Sources

**Goal:** Add CSV reader, URI resolver, and semantic loader for telemetry-backed const series.

### Task 2.1: CSV File Reader
**Files:** `src/FlowTime.Core/DataSources/CsvReader.cs`, `tests/FlowTime.Core.Tests/DataSources/CsvReaderTests.cs`

**Checklist (TDD order):**
- [x] RED: Write tests for happy path, sparse bins, invalid header, missing file, and bad indices.
- [x] GREEN: Implement CSV reader using invariant culture and header validation.
- [ ] Commit: `test(core): add csv reader coverage`
- [ ] Commit: `feat(core): implement telemetry csv reader`

**Status:** üîÑ In Progress

### Task 2.2: URI Resolution
**Files:** `src/FlowTime.Core/DataSources/UriResolver.cs`, `tests/FlowTime.Core.Tests/DataSources/UriResolverTests.cs`

**Checklist (TDD order):**
- [x] RED: Tests for relative path resolution, absolute paths, unsupported schemes, and missing model directory.
- [x] GREEN: Implement resolver logic.
- [ ] Commit: `test(core): cover uri resolver`
- [ ] Commit: `feat(core): add file uri resolver`

**Status:** üîÑ In Progress

### Task 2.3: Semantic Data Loader
**Files:** `src/FlowTime.Core/DataSources/SemanticLoader.cs`, `src/FlowTime.Core/Models/NodeData.cs`, `tests/FlowTime.Core.Tests/DataSources/SemanticLoaderTests.cs`

**Checklist (TDD order):**
- [x] RED: Tests loading required semantics, optional semantics, and error propagation from reader.
- [x] GREEN: Implement loader using CSV reader + resolver.
- [ ] Commit: `test(core): semantic loader coverage`
- [ ] Commit: `feat(core): load node semantic telemetry`

**Phase Validation:**
- [ ] All new data source tests green
- [ ] Integration with parser pending Phase 3+

**Status:** üîÑ In Progress

---

## Phase 3: Initial Conditions

**Goal:** Validate conservation at bin 0 using explicit initial conditions on series.

### Task 3.1: Initial Condition Validator
**Files:** `src/FlowTime.Core/Validation/InitialConditionValidator.cs`, `tests/FlowTime.Core.Tests/Validation/InitialConditionValidatorTests.cs`

**Checklist (TDD order):**
- [ ] RED: Tests for valid/invalid conservation, optional queue depth, zero default when no initial provided.
- [ ] GREEN: Implement validator logic with tolerance handling.
- [ ] Commit: `test(core): add initial condition validator coverage`
- [ ] Commit: `feat(core): validate queue initial conditions`

**Status:** üîÑ In Progress

---

## Phase 4: Fixtures

**Goal:** Provide reusable telemetry fixtures (Order, Microservices, HTTP) with supporting tests.

### Task 4.1: Order System Fixture
**Files:** `fixtures/order-system/*`, `tests/FlowTime.Core.Tests/Fixtures/OrderSystemFixtureTests.cs`

**Checklist (TDD order):**
- [ ] RED: Fixture tests asserting topology, data lengths, and initial conditions.
- [ ] GREEN: Create CSVs and model YAML matching specs.
- [ ] GREEN: Ensure data supports integration scenarios (consistent bins).
- [ ] Commit: `test(core): add order system fixture tests`
- [ ] Commit: `chore(fixtures): add order system telemetry fixture`

**Status:** ‚è≥ Not Started

### Task 4.2: Microservices Fixture
**Files:** `fixtures/microservices/*`, `tests/FlowTime.Core.Tests/Fixtures/MicroservicesFixtureTests.cs`

**Checklist (TDD order):**
- [ ] RED: Tests covering 6-node topology, edge structure, and data sanity.
- [ ] GREEN: Author fixture YAML + CSVs.
- [ ] Commit: `test(core): add microservices fixture tests`
- [ ] Commit: `chore(fixtures): add microservices telemetry fixture`

**Status:** ‚è≥ Not Started

### Task 4.3: HTTP Service Fixture
**Files:** `fixtures/http-service/*`, `tests/FlowTime.Core.Tests/Fixtures/HttpServiceFixtureTests.cs`

**Checklist (TDD order):**
- [ ] RED: Tests verifying single-node fixture loads and respects start time.
- [ ] GREEN: Provide YAML + CSV artifacts.
- [ ] Commit: `test(core): add http service fixture tests`
- [ ] Commit: `chore(fixtures): add http service telemetry fixture`

**Phase Validation:**
- [ ] All fixture tests green
- [ ] Data reused by integration tests

**Status:** ‚è≥ Not Started

---

## Phase 5: Integration Tests

**Goal:** Validate end-to-end loading, absolute time computation, and initial condition flow using fixtures.

### Task 5.1: End-to-End Tests
**Files:** `tests/FlowTime.Core.Tests/Integration/TimeGridWithFileSourcesTests.cs`, supporting fixture assets

**Checklist (TDD order):**
- [ ] RED: Integration tests covering load ‚Üí validate ‚Üí grid pipeline and backward compatibility checks.
- [ ] GREEN: Wire semantic loader, validator, and window start time into integration path.
- [ ] Commit: `test(core): add file-source integration coverage`
- [ ] Commit: `feat(core): enable file-sourced time grid`

**Phase Validation:**
- [ ] Entire test suite passes
- [ ] Fixtures demonstrate reproducible runs

**Status:** ‚è≥ Not Started

---

## Testing & Validation

### Planned Test Cases
- [ ] `WindowTests` (absolute time, bin alignment)
- [ ] `TopologyTests` (node + edge navigation)
- [ ] `CsvReaderTests` (headered CSV parsing)
- [ ] `UriResolverTests` (relative/absolute paths)
- [ ] `SemanticLoaderTests` (required + optional semantics)
- [ ] `InitialConditionValidatorTests`
- [ ] Fixture tests (Order, Microservices, HTTP)
- [ ] Integration tests (file-sourced time grid, start time propagation)
- [ ] Regression sweep: `dotnet test` full solution

**Exit Criteria:**
- All new tests passing; no skipped tests.
- Full solution builds cleanly with fixtures included.
- Existing regression suite (M2.10) remains green.

---

## Issues & Risks

- Serena MCP tooling unavailable in Codex environment; ensure manual edits stay scoped and linted.
- Fixture CSV authoring may be time-consuming; consider scripting generation to avoid manual errors.
- Large number of new files may require incremental commits; maintain RED‚ÜíGREEN discipline.
