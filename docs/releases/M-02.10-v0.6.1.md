# Release M-02.10 - v0.6.1

**Release Date:** October 5, 2025  
**Type:** Small Milestone (Feature Addition)  
**Version:** 0.6.1

## Overview

M-02.10 adds comprehensive provenance query support across both the CLI and API, enabling users to filter artifacts by their template and model origins. This release enhances artifact discovery and supports workflows where users need to identify artifacts created from specific templates or simulation models.

## Key Features

### API Enhancements
- **Provenance Query Parameters** (`/v1/artifacts`)
  - `templateId`: Filter artifacts by template identifier
  - `modelId`: Filter artifacts by simulation model identifier
  - Support for combined queries (both filters together)
  - Maintains backward compatibility (all parameters optional)

### CLI Improvements
- **`artifacts list` Command with Provenance Filters**
  - `--template <templateId>`: Filter by template identifier
  - `--model <modelId>`: Filter by simulation model identifier
  - Offline operation: CLI reads directly from registry (no API required)
  - Deterministic sorting: artifacts sorted by timestamp (oldest first)

### Architecture
- **Stable Sorting**: Consistent artifact ordering across API and CLI
- **Optional Filters**: All query parameters are optional, supporting flexible workflows
- **Direct Registry Access**: CLI operates independently of API for offline scenarios

## Test Coverage

- **15/15 tests passing** for provenance query functionality
- Coverage across:
  - API query parameter handling (single and combined filters)
  - CLI argument parsing and filtering logic
  - Registry index operations
  - Edge cases (no matches, empty registry, invalid filters)

## Breaking Changes

None. This release is fully backward compatible with v0.6.0.

## Migration Guide

No migration required. Existing workflows continue to work unchanged.

## Known Issues

None.

## What's Next

M-02.10 completes the provenance query capability. Next milestones will focus on:
- **M-03.00**: Graph API for dependency visualization
- **M-04.00**: Simulation integration
- **Future**: Enhanced artifact metadata and search capabilities

---

## Technical Details

### API Changes

**New Query Parameters:**
```
GET /v1/artifacts?templateId={id}
GET /v1/artifacts?modelId={id}
GET /v1/artifacts?templateId={tid}&modelId={mid}
```

**Response Format:** (unchanged)
```json
{
  "artifacts": [
    {
      "id": "abc123",
      "templateId": "template-1",
      "modelId": "model-1",
      "timestamp": "2025-10-05T12:00:00Z"
    }
  ]
}
```

### CLI Changes

**New Arguments:**
```bash
# Filter by template
ft artifacts list --template template-1

# Filter by model
ft artifacts list --model model-1

# Combine filters
ft artifacts list --template template-1 --model model-1
```

**Output Format:** (unchanged, CSV)
```csv
id,templateId,modelId,timestamp
abc123,template-1,model-1,2025-10-05T12:00:00Z
```

### Implementation Highlights

- **CLI Architecture**: Direct registry access via `IArtifactRegistry` interface
- **API Implementation**: Query parameter binding with optional filters
- **Sorting**: `OrderBy(a => a.Timestamp)` ensures deterministic results
- **Testing Strategy**: Comprehensive coverage of filter combinations and edge cases

---

## Contributors

This release includes contributions to:
- API endpoint enhancements
- CLI command implementation
- Test suite expansion
- Documentation updates

## Release Artifacts

- **Tag:** `v0.6.1`
- **Commit:** `6cf2da3` (version bump)
- **Branch:** `main` (merged from `feature/api-m2.10/provenance-queries`)

## Verification

```bash
# Verify version
dotnet run --project src/FlowTime.Cli -- --version
# Expected: FlowTime CLI v0.6.1

# Run tests
dotnet test
# Expected: 15/15 M-02.10 tests passing

# Test CLI provenance query
ft artifacts list --template my-template
# Expected: Filtered artifact list
```

---

**Previous Release:** [M-02.09 - v0.6.0](M-02.09-v0.6.0.md)  
**Milestone:** M-02.10  
**Status:** âœ… Complete
