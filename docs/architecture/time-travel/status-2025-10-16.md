# FlowTime Time-Travel Status — 2025-10-16

## Request Summary
On 2025-10-16 the time-travel working group asked for a thorough snapshot of the implementation, with special attention to outstanding roadmap items, gaps that block UI work, and any inconsistencies that surfaced during the recent Engine and Sim sprints. This report captures that analysis and will continue to evolve as we resolve open items.

## Executive Snapshot
- Engine time-travel endpoints and telemetry workflows are implemented; M-03.01 features are live in code.
- Telemetry capture, bundling, and Sim template generation form a working pipeline, but milestone docs still read as “planned/in progress”.
- UI consumers can rely on current `/state` contracts, yet there is no first-class API to create or list time-travel runs, and topology layout metadata is missing.
- Documentation across milestones and Sim plans is out of sync with shipped behaviour; roadmap clarity suffers.

## Current Implementation Highlights
- **State APIs delivered**: `/v1/runs/{runId}/state` and `/state_window` expose metadata, derived metrics, and telemetry provenance (`src/FlowTime.API/Program.cs:606`, `src/FlowTime.API/Services/StateQueryService.cs:14`).
- **Contracts locked**: DTOs for snapshots, window slices, and node telemetry warnings live under `src/FlowTime.Contracts/TimeTravel/StateContracts.cs:1` and back the published schema `docs/schemas/time-travel-state.schema.json`.
- **Telemetry pipeline**: CLI commands `flowtime telemetry capture` and `flowtime telemetry bundle` orchestrate capture → manifest → bundling (`src/FlowTime.Cli/Commands/TelemetryCaptureCommand.cs:8`, `src/FlowTime.Cli/Commands/TelemetryBundleCommand.cs:8`) with golden coverage in `tests/FlowTime.Generator.Tests/TelemetryStateGoldenTests.cs:12`.
- **Sim alignment**: Templates emit KISS schema constructs (window, topology, telemetry sources) as shown in `templates/it-system-microservices.yaml:1` and supporting types in `src/FlowTime.Sim.Core/Templates/Template.cs:1`.
- **Run orchestration service**: Shared `RunOrchestrationService` powers `/v1/runs` create/list/detail endpoints (`src/FlowTime.API/Endpoints/RunOrchestrationEndpoints.cs:1`) and the CLI wrapper `flowtime telemetry run` (`src/FlowTime.Cli/Commands/TelemetryRunCommand.cs:1`), so UI/CLI share the same bootstrap path.

## Inconsistencies and Documentation Gaps
- **Milestone status drift**: `docs/milestones/M-03.01.md`, `docs/milestones/M-03.02.md`, and `docs/milestones/SIM-M-03.00.md` still claim Planned/In Progress despite code completion; tracking logs disagree.
- **Sim implementation plan mismatch**: `docs/architecture/time-travel/sim/sim-implementation-plan.md` notes WS1/WS2 as unscheduled even though work is merged.
- **Architecture vs. reality**: Chapter 4 and roadmap documents still assume an ADX TelemetryLoader; no runtime component exists beyond capture tooling.
- **Legacy run entry point**: Engine relies on `POST /v1/run` with raw YAML (`src/FlowTime.API/Program.cs:426`); the roadmap’s structured `POST /v1/runs` flow is missing.
- **Template layout metadata**: Curated templates omit `topology.ui` hints, leaving UI layouts undefined; no guideline exists for client rendering.

- ✅ **Available today**: Stable topology semantics, per-bin metrics, derived utilization/latency data, telemetry warning propagation, canonical demo bundles, provenance metadata, and API/CLI support for creating and listing runs.
- ⚠️ **Blocking gaps**:
  1. No discovery endpoint for templates or run filtering/pagination (UI still needs catalog metadata).
  2. Absent topology layout hints make consistent graph rendering difficult.
  3. Docs still describe M2.x behaviour, risking confusion during UI planning.

## Immediate Priorities (Proposed)
1. **Document API/CLI workflow**: Update `.http` samples and operator guides with the new `/v1/runs` contract and CLI wrapper.
2. **Synchronise milestone docs**: Update M-03.01, M-03.02, SIM-M-03.00, and associated tracking files to reflect completion and remaining follow-ups.
3. **Document or provide layout hints**: Either enrich templates with `topology.ui` metadata or publish the agreed deterministic layout rules for clients.

## Supporting Notes
- Telemetry provenance is already mirrored between manifests and API responses via `metadata.telemetrySourcesResolved` and per-node warnings.
- Golden tests assert telemetry playback for Order System, Microservices, and HTTP fixtures, giving high confidence in snapshot fidelity.
- Scripts such as `scripts/time-travel/run-sim-template.sh` simplify template instantiation but depend on manual CLI orchestration until server APIs land.

*This status document will evolve throughout the session; capture new findings here as they surface.*
