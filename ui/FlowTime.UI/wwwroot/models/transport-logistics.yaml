grid:
  bins: 24
  binMinutes: 60
nodes:
  - id: passenger_demand
    kind: const
    values: [50, 30, 25, 20, 35, 120, 280, 450, 380, 220, 180, 200, 240, 190, 160, 180, 320, 480, 420, 280, 180, 120, 80, 60]
  - id: bus_capacity
    kind: const
    values: [40, 25, 20, 15, 25, 80, 120, 150, 130, 100, 90, 95, 100, 90, 85, 90, 110, 160, 140, 120, 90, 70, 50, 45]
  - id: weather_factor
    kind: const
    values: [1.0, 1.0, 1.0, 1.0, 1.0, 1.2, 1.3, 1.1, 0.9, 0.8, 0.7, 0.8, 0.9, 0.8, 0.7, 0.9, 1.1, 1.4, 1.2, 1.0, 1.0, 1.0, 1.0, 1.0]
  - id: actual_demand
    kind: expr
    expr: "passenger_demand * weather_factor"
  - id: utilization_pct
    kind: expr
    expr: "MIN(actual_demand / bus_capacity * 100, 150)"
  - id: avg_wait_minutes
    kind: expr
    expr: "CLAMP(2 + (utilization_pct - 80) * 0.3, 2, 25)"
  - id: service_quality
    kind: expr
    expr: "CLAMP(100 - utilization_pct * 0.4 - avg_wait_minutes * 2, 0, 100)"
  - id: delayed_buses
    kind: expr
    expr: "MAX(utilization_pct - 100, 0) * 0.8"
  - id: revenue_per_hour
    kind: expr
    expr: "MIN(actual_demand, bus_capacity * 1.2) * 2.50"
outputs:
  - series: service_quality
    as: transport.csv